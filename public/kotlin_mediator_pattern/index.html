<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    










    







<script defer language="javascript" type="text/javascript" src="/js/bundle.min.91ae35f985ba4ae6473b8defee39551f3ce6ed2769fdfa9b3df93f2eac0da4bc.js"></script>






    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <link rel="icon" href=/assets/favicon.ico>

    
    





  





  
  
  


<!-- Open Graph image and Twitter Card metadata -->

<title itemprop="name">Adam Świderski - Mediator in Kotlin</title>
<meta property="og:title" content=Adam&#32;Świderski&#32;-&#32;Mediator&#32;in&#32;Kotlin />
<meta name="twitter:title" content=Adam&#32;Świderski&#32;-&#32;Mediator&#32;in&#32;Kotlin />
<meta itemprop="name" content=Adam&#32;Świderski&#32;-&#32;Mediator&#32;in&#32;Kotlin />
<meta name="application-name" content=Adam&#32;Świderski&#32;-&#32;Mediator&#32;in&#32;Kotlin />
<meta property="og:site_name" content="My New Hugo Site" />


<meta name="description" content=" The Mediator&#39;s job is to organize communication between close classes. The `Mediator` pattern cuts out dependencies between components. It takes over the interaction between them, becoming the main communication hub for a group of classes. There is a reverse of the controls because components are now just telling &#39;what happened&#39; instead of telling others to &#39;do something&#39;. It can be found e.g. in the form of `ViewModel` in Android, where it separates UI interactions from data model changes. " />
<meta itemprop="description" content=" The Mediator&#39;s job is to organize communication between close classes. The `Mediator` pattern cuts out dependencies between components. It takes over the interaction between them, becoming the main communication hub for a group of classes. There is a reverse of the controls because components are now just telling &#39;what happened&#39; instead of telling others to &#39;do something&#39;. It can be found e.g. in the form of `ViewModel` in Android, where it separates UI interactions from data model changes. " />
<meta property="og:description" content=" The Mediator&#39;s job is to organize communication between close classes. The `Mediator` pattern cuts out dependencies between components. It takes over the interaction between them, becoming the main communication hub for a group of classes. There is a reverse of the controls because components are now just telling &#39;what happened&#39; instead of telling others to &#39;do something&#39;. It can be found e.g. in the form of `ViewModel` in Android, where it separates UI interactions from data model changes. " />
<meta name="twitter:description" content=" The Mediator&#39;s job is to organize communication between close classes. The `Mediator` pattern cuts out dependencies between components. It takes over the interaction between them, becoming the main communication hub for a group of classes. There is a reverse of the controls because components are now just telling &#39;what happened&#39; instead of telling others to &#39;do something&#39;. It can be found e.g. in the form of `ViewModel` in Android, where it separates UI interactions from data model changes. " />


<base href="http://localhost:1313/kotlin_mediator_pattern/" />
<link rel="canonical" href="http://localhost:1313/kotlin_mediator_pattern/" itemprop="url" />
<meta name="url" content="http://localhost:1313/kotlin_mediator_pattern/" />
<meta name="twitter:url" content="http://localhost:1313/kotlin_mediator_pattern/" />
<meta property="og:url" content="http://localhost:1313/kotlin_mediator_pattern/" />


<meta property="og:updated_time" content=17007-17-12T70:00:21Z />


<link rel="sitemap" type="application/xml" title="Sitemap" href='http://localhost:1313/sitemap.xml' />

<meta name="robots" content="index,follow" />
<meta name="googlebot" content="index,follow" />


<meta name="twitter:site" content="" />
<meta name="twitter:creator" content="" />
<meta property="fb:admins" content="" />


<meta name="apple-mobile-web-app-title" content="My New Hugo Site" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />





<meta property="og:type" content="article" />
<meta property="article:publisher" content="" />
<meta property="og:article:published_time" content=17007-17-12T70:00:21Z />
<meta property="article:published_time" content=17007-17-12T70:00:21Z />








<meta name="generator" content="Hugo 0.123.7">


    
    

<link type="text/css" rel="stylesheet" href="/css/bundle.min.94a339836f89f0d25f31980cb6b0631da21e20af128308747ce44e0525eb16ef.css">


    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5A5A5A;
        --link-color: #268BD2;
        --date-color: #515151;
        --table-border-color: #E5E5E5;
        --table-stripe-color: #F9F9F9;
        --code-color: #000;
        --code-background-color: #E5E5E5;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #EEE;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #bebebe;
        --link-color: #268BD2;
        --date-color: #9A9A9A;
        --table-border-color: #515151;
        --table-stripe-color: #202020;
        --code-color: #FFF;
        --code-background-color: #515151;
        --code-block-color: #FFF;
        --code-block-background-color: #272822;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

</head>

    <body class="dark-theme">
        <div class="wrapper">
            <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark" title="Toggle light/dark mode">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="http://localhost:1313/">
                <img src="/assets/profile_picture.png" alt="brand image">
            </a>
        
        
            <a href="http://localhost:1313/">
                <h1>Adam Świderski</h1>
            </a>
        
    </h1>
    <p class="lead">
    software engineer
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">

        
        
        
        
            

            
                
                
            
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        
        
            

            
                
                
                    <li class="heading">
                        <a href="/posts/">Posts</a>
                    </li>
                    
                        <li class="sub-heading">
                            Recent
                        </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/2024-02-24-MVI/">Android Presentation Patterns: MVI</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/2024-02-09-MVVM/">Android Presentation Patterns: MVVM</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/2024-01-29-MVP/">Android Presentation Patterns: MVP</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/2024-01-27-MVC/">Android Presentation Patterns: MVC</a>
                            </li>
                        
                            <li class="bullet">
                                <a href="http://localhost:1313/2023-06-16-ci-is-your-friend/">Continuous Integration and Deployment: A Developer&#39;s Best Friends</a>
                            </li>
                        
                    
                
            
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
                
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
                        
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" title="GitHub" href="https://github.com">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>



    <a target="_blank" class="social" title="LinkedIn" href="https://linkedin.com">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>






    <a target="_blank" class="social" title="YouTube" href="https://youtube.com">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12.006 19.012h-.02c-.062 0-6.265-.012-7.83-.437a2.5 2.5 0 0 1-1.764-1.765A26.494 26.494 0 0 1 1.986 12a26.646 26.646 0 0 1 .417-4.817A2.564 2.564 0 0 1 4.169 5.4c1.522-.4 7.554-.4 7.81-.4H12c.063 0 6.282.012 7.831.437c.859.233 1.53.904 1.762 1.763c.29 1.594.427 3.211.407 4.831a26.568 26.568 0 0 1-.418 4.811a2.51 2.51 0 0 1-1.767 1.763c-1.52.403-7.553.407-7.809.407Zm-2-10.007l-.005 6l5.212-3l-5.207-3Z"/>
        </svg>
    </a>








    <a target="_blank" class="social" title="RSS Feed" href="/posts/index.xml">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 1280.000000 1280.000000">
            <g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="currentColor">
                <path d="M2295 11929 c-284 -12 -642 -45 -707 -65 -17 -5 -18 -63 -18 -1039 0 -569 4 -1036 8 -1039 5 -3 74 6 153 19 510 86 1168 95 1789 25 1348 -153 2602 -677 3670 -1531 385 -308 820 -744 1126 -1129 842 -1060 1362 -2313 1514 -3650 70 -621 61 -1279 -25 -1789 -13 -79 -22 -148 -19 -153 3 -4 471 -8 1039 -8 l1035 0 5 23 c51 225 85 942 67 1419 -23 605 -77 1044 -198 1617 -294 1400 -927 2734 -1823 3846 -1043 1295 -2364 2259 -3909 2854 -1158 447 -2451 656 -3707 600z"/>
                <path d="M2255 7845 c-269 -25 -620 -81 -667 -106 -17 -9 -18 -55 -18 -899 0 -706 3 -890 13 -890 6 0 66 18 132 41 130 44 288 79 467 105 154 21 577 30 749 15 1207 -107 2267 -823 2814 -1902 166 -327 268 -637 330 -1001 38 -227 48 -384 42 -662 -8 -348 -44 -590 -126 -831 -23 -66 -41 -126 -41 -132 0 -10 184 -13 890 -13 844 0 890 1 899 18 27 50 88 452 110 725 14 162 14 624 1 782 -59 703 -233 1323 -545 1945 -481 956 -1313 1788 -2270 2268 -620 310 -1239 483 -1940 542 -165 14 -669 10 -840 -5z"/>
                <path d="M2519 3815 c-391 -66 -725 -336 -868 -703 -79 -201 -96 -462 -45 -677 83 -344 338 -641 666 -774 116 -47 205 -69 330 -80 412 -39 811 153 1040 500 193 292 240 648 128 981 -135 403 -492 699 -914 757 -100 14 -241 12 -337 -4z"/>
            </g>
        </svg>
    </a>


    <a target="_blank" class="social" title="Email" href="mailto://user@domain">
       <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 485.211 485.211">
            <path fill="currentColor" d="M301.393,241.631L464.866,424.56H20.332l163.474-182.928l58.801,51.443L301.393,241.631z M462.174,60.651H23.027 l219.579,192.142L462.174,60.651z M324.225,221.67l160.986,180.151V80.792L324.225,221.67z M0,80.792v321.029L160.972,221.64 L0,80.792z"/>
       </svg>
    </a>


        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2024 My New Hugo Site. All rights reserved.
</p>

  </div>
</aside>

            <main class="content container">
                <div class="post">
  <div class="info">
  <h1 class="post-title">
    <a href="http://localhost:1313/kotlin_mediator_pattern/">Mediator in Kotlin</a>
  </h1>

  <div class="headline">
    <div>
      
      <time datetime=" 2021-07-17T00:00:00Z" class="post-date">
        July 17, 2021
      </time>
      
      <span> - </span>
      <span class="reading-time">
        
          
        

        <span>11 mins read</span>
      </span>
    </div>

    
    <ul class="tags">
      
      <li class="tag-kotlin">
        <a href="http://localhost:1313/tags/kotlin">kotlin</a>
      </li>
      
      <li class="tag-Mediator Pattern">
        <a href="http://localhost:1313/tags/mediator-pattern">Mediator Pattern</a>
      </li>
      
      <li class="tag-design patterns">
        <a href="http://localhost:1313/tags/design-patterns">design patterns</a>
      </li>
      
    </ul>
    
  </div>

  
  

  
</div>

  <h1 id="purpose">Purpose</h1>
<p>We define a <code>Mediator</code> as an object encapsulating interactions between other objects (<code>components</code>) from a given set. The pattern limits, or even cuts off completely, direct dependencies between classes. Components can only communicate with each other through the <code>Mediator</code>, which becomes the central hub for information and control. The <code>Mediator</code> controls the flow of information using its internal logic.</p>
<p>This can be compared to the air traffic control tower (ATC). Pilots of all planes from the area communicate with it, and it is the tower that decides the order of take-offs and landings. However, the ATC does not control the entire flight in all aspects, but only organizes the planes in relation to each other. Its easy to imagine the chaos, when the pilots of all machines had to communicate directly with each other to determine who was to land next.</p>
<p>For this reason, the <code>Mediator</code> pattern seems to me <strong>to fit rather for refactoring</strong> close-by classes, the number of interactions of which has already begun to disturb their maintenance, but have well-established responsibilities. In some cases, the use of <code>Mediator</code> will make sense from the very beginning of code development, but it can also be an overkill.</p>
<p>A fairly common use of this pattern is <a href="https://developer.android.com/topic/libraries/architecture/viewmodel" target="_blank">View Model</a> known from <code>Android Architecture Components</code>. It intercepts interactions with the UI and, according to its logic, informs the data model and the other way around - it passes changes in the model to the UI.</p>
<h1 id="implementation">Implementation</h1>
<p>The mediator has a very simple structure, there are 2 types of objects:</p>
<ul>
<li><strong>Mediator</strong> - the main communication hub, known to all <code>components</code></li>
<li><strong>Component</strong> - doesn&rsquo;t know other components, doesn&rsquo;t depend on them (though it may depend on other classes). It communicates only with the <code>Mediator</code> who is calling appropriate<code>components</code></li>
</ul>
<p>{% plantuml %}
@startuml</p>
<p>interface Mediator{
+ notify(sender, event, context)
}
class ConcreteMediator implements Mediator{
- componentA: ComponentA
- componentB: ComponentB
- componentC: ComponentC
+ notify(sender, event, context)
}</p>
<p>class ComponentA{
- mediator: Mediator
}
class ComponentB{
- mediator: Mediator
}
class ComponentC{
- mediator: Mediator
}</p>
<p>ComponentA &ndash;* ConcreteMediator::componentA
ComponentB &ndash;* ConcreteMediator::componentB
ComponentC &ndash;* ConcreteMediator::componentC</p>
<p>ComponentA::mediator-left-&gt;ConcreteMediator::notify
ComponentB::mediator-right-&gt;ConcreteMediator::notify
ComponentC::mediator-up-&gt;ConcreteMediator::notify</p>
<p>@enduml
{% endplantuml %}</p>
<p>It is worth noting that the only interface needed is <code>Mediator</code>, which all the<code> components</code> know. Each <code>component</code> is a separate and independent object that probably already inherits from another class or implements the needed interfaces. You may be tempted to introduce an additional <code>Component</code> interface, but it would not do much, because the <code>Mediator</code> needs to know the specific interfaces of its <code>components</code> to be able to call specific methods after receiving the message.</p>
<p>The <code>mediator</code> object can get components in the constructor, via DI, or even create the necessary instances and manage their lifecycle.</p>
<h2 id="abstract-implementation">Abstract implementation</h2>
<p>Let&rsquo;s see how it may look in code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Mediator</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// mediator declares methods for communication
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">method</span>(sender: Any, args: Any? = <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// components don&#39;t have to share any interface, but they all have to have reference to the Mediator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// they shouldn&#39;t have dependencies to eachother, it kills the point of having a Mediator in between
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ComponentA</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> mediator: Mediator) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">operationA</span>() {
</span></span><span style="display:flex;"><span>        mediator.method(<span style="color:#66d9ef">this</span>, <span style="color:#e6db74">&#34;arg A&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ComponentB</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> mediator: Mediator) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">operationB</span>() {
</span></span><span style="display:flex;"><span>        mediator.method(<span style="color:#66d9ef">this</span>, <span style="color:#ae81ff">10.34</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ComponentC</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> mediator: Mediator) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">operationC</span>() {
</span></span><span style="display:flex;"><span>        mediator.method(<span style="color:#66d9ef">this</span>, println(<span style="color:#e6db74">&#34;print me!&#34;</span>))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Mediator encapsulates relationships between components
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// it has references to all components it manages
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// and sometimes it can even manage component lifecycle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Concretemediator</span> : Mediator { 
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// components may be injected or passed in constructor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// but Mediator reference must be passed to each component
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> componentA = ComponentA(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> componentB = ComponentB(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> componentC = ComponentC(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">method</span>(sender: Any, args: Any?) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// checking which object is sender
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">when</span> (sender) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Mediator knows how to handle the incoming message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">is</span> ComponentA <span style="color:#f92672">-&gt;</span> println(<span style="color:#e6db74">&#34;arg from A: </span><span style="color:#e6db74">$args</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">is</span> ComponentB <span style="color:#f92672">-&gt;</span> println(<span style="color:#e6db74">&#34;arg from B: </span><span style="color:#e6db74">${args as Float * 3}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">is</span> ComponentC <span style="color:#f92672">-&gt;</span> (args <span style="color:#66d9ef">as</span> () <span style="color:#f92672">-&gt;</span> Any).invoke()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Instead of the <code>notify(sender, event, context)</code> method, I used <code>method(sender, args)</code> here, but the principle is the same, the <code>Mediator</code> interface determines the form of communication. The <code>event</code> in the former case can be an object inheriting from some generic interface, or a <code>sealed class</code>, which will create a nice closed set of events that is easier to navigate through.</p>
<p><code>Context</code> can indicate where the message is coming from, e.g. whether the product was added to the shopping cart from the list of recommended additional products or directly from the product page. The arguments of the method, or even the <code>Mediator</code> methods, will depend heavily on the specific implementation, and the information needed.</p>
<h2 id="dialog">Dialog</h2>
<p>A common example of using <code>Mediator</code> is dialog boxes that contain UI elements such as buttons and text inputs. Oftentimes, the state of user interface elements depends on one another. The &ldquo;OK&rdquo; button should be inactive, if not all required form fields have been filled, etc. If there are many view elements, the number of such dependencies between them may increase and be difficult to control.</p>
<p>Therefore, it is a good idea to have a central communication hub that will collect events from the UI elements and adjust the state of the displayed elements accordingly. The <code>Dialog</code> itself can be such a <code>Mediator</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// view manager, controlling UI elements inside it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UiDirector</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// `event` is naive String for simplifying the example
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// `sender` has to be UI element extending `UiElement` class
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">notify</span>(sender: UiElement, event: String)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// `UiElement` class is an UI component inside `UiDirector`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UiElement</span>(<span style="color:#66d9ef">val</span> uiDirector: UiDirector)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// button is UI element
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Button</span>(uiDirector: UiDirector) : UiElement(uiDirector) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">click</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// that informs `uiDirector` about being clicked
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// but has no other logic regarding this
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        uiDirector.notify(<span style="color:#66d9ef">this</span>, <span style="color:#e6db74">&#34;click&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TextBox</span>(uiDirector: UiDirector) : UiElement(uiDirector) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TextBox is also an UI element
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// lets assume it has inner logic refreshing value of the `text` field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// that takes care of pasting the text or manual typing it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// using `observable` makes sure that after each change the `uiDirector` gets notified
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// there is no need to remember about calling `notify()` in every place that changes `text`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> text: String <span style="color:#66d9ef">by</span> <span style="color:#a6e22e">Delegates</span>.observable(<span style="color:#e6db74">&#34;&#34;</span>) { <span style="color:#66d9ef">property</span>, oldValue, newValue <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        uiDirector.notify(<span style="color:#66d9ef">this</span>, <span style="color:#e6db74">&#34;text_changed&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Dialog window, handles view state according to UI components events
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FancyDialog</span> : UiDirector {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> title = <span style="color:#e6db74">&#34;fancy dialog&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// dialog creates instances of its `components`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> okButton = Button(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> cancelButton = Button(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = TextBox(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> inputText = <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">notify</span>(sender: UiElement, event: String) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">when</span> (sender) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// after each UI component change it gets update
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            input <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (event <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;text_change&#34;</span>) inputText = input.text
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// and has logic called after buttons are clicked
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            okButton <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (event <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;click&#34;</span>) submit()
</span></span><span style="display:flex;"><span>            cancelButton <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (event <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;click&#34;</span>) dismiss()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">dismiss</span>() {}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">submit</span>() {}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This allows reusing the implementation of the UI controls as they don&rsquo;t have any specific logic other than managing their state. The <code>Delegates.observable</code> in the <code>TextBox</code> class makes it easy to notify the view manager of a change. No need to do this in every place that updates the <code>text</code> field.</p>
<h2 id="chat">Chat</h2>
<p>An interesting example of the &lsquo;Mediator&rsquo; pattern is chat. We have participants who send messages publicly or directly to another participant, but it is the <code>Chat</code> object that decides who gets which message.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// helper alias
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typealias</span> ParticipantName = String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Mediator interface
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Chatroom</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">registerParticipant</span>(participant: Participant)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// message recipient is optional, when left empty the message is public
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">send</span>(message: String, from: ParticipantName, to: ParticipantName? = <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Participant class has very simple API, limited to sending and receiving the message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// no logic controlling where the message actually goes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Participant</span>(<span style="color:#66d9ef">val</span> name: String, <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> chatroom: Chatroom) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">init</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// the participant is registering itself in the chatroom
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        chatroom.registerParticipant(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// is able to send the message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">send</span>(message: String, to: ParticipantName? = <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        chatroom.send(message, <span style="color:#66d9ef">this</span>.name, to)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// and receive it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">receive</span>(message: String) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;[</span><span style="color:#e6db74">$name</span><span style="color:#e6db74">] gets: </span><span style="color:#e6db74">$message</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// `object` is here just to make it easier to use in `main()`
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">SuperChat</span> : Chatroom {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// chatroom modes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mode</span> { 
</span></span><span style="display:flex;"><span>        PUBLIC, <span style="color:#75715e">// every message is delivered to every participant
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        PRIVATE, <span style="color:#75715e">// only messages with recipient will be delivered
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        MIXED <span style="color:#75715e">// both direct messages and public ones will be delivered
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> mode: Mode = <span style="color:#a6e22e">Mode</span>.PRIVATE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> participants = mutableListOf&lt;Participant&gt;()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">registerParticipant</span>(participant: Participant) {
</span></span><span style="display:flex;"><span>        participants.add(participant)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// handling messages
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">send</span>(message: String, from: ParticipantName, to: ParticipantName?) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">when</span> (mode) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// depending on the mode they will be handled differently
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">Mode</span>.PUBLIC <span style="color:#f92672">-&gt;</span> participants.forEach { <span style="color:#66d9ef">it</span>.receive(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$from</span><span style="color:#e6db74"> says: </span><span style="color:#e6db74">$message</span><span style="color:#e6db74">&#34;</span>) }
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Mode</span>.PRIVATE <span style="color:#f92672">-&gt;</span> participants.find { <span style="color:#66d9ef">it</span>.name <span style="color:#f92672">==</span> to }<span style="color:#f92672">?.</span>receive(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$from</span><span style="color:#e6db74"> says: </span><span style="color:#e6db74">$message</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Mode</span>.MIXED <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (to <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) participants.forEach { <span style="color:#66d9ef">it</span>.receive(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$from</span><span style="color:#e6db74"> says: </span><span style="color:#e6db74">$message</span><span style="color:#e6db74">&#34;</span>) }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span> participants.find { <span style="color:#66d9ef">it</span>.name <span style="color:#f92672">==</span> to }<span style="color:#f92672">?.</span>receive(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$from</span><span style="color:#e6db74"> says: </span><span style="color:#e6db74">$message</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> alice = Participant(<span style="color:#e6db74">&#34;Alice&#34;</span>, SuperChat)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> bob = Participant(<span style="color:#e6db74">&#34;Bob&#34;</span>, SuperChat)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> charlie = Participant(<span style="color:#e6db74">&#34;Charlie&#34;</span>, SuperChat)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    alice.send(<span style="color:#e6db74">&#34;hi all!&#34;</span>)
</span></span><span style="display:flex;"><span>    bob.send(<span style="color:#e6db74">&#34;hi Alice&#34;</span>, <span style="color:#e6db74">&#34;Alice&#34;</span>) <span style="color:#75715e">// only this message will be delivered in PRIVATE mode
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    charlie.send(<span style="color:#e6db74">&#34;hi Alice&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">SuperChat</span>.mode = <span style="color:#a6e22e">SuperChat</span>.<span style="color:#a6e22e">Mode</span>.PUBLIC
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Since chat mode is initially <code>PRIVATE</code>, only the message with the recipient will be printed <code>[Alice] gets: Bob says: hi Alice</code>. The rest of the messages will go to the <code>Mediator</code> but not to the other participants. Changing the message delivery policy will have this effect for <code>MIXED</code>:</p>
<pre tabindex="0"><code>[Alice] gets: Alice says: hi all!
[Bob] gets: Alice says: hi all!
[Charlie] gets: Alice says: hi all!
[Alice] gets: Bob says: hi Alice
[Alice] gets: Charlie says: hi Alice
[Bob] gets: Charlie says: hi Alice
[Charlie] gets: Charlie says: hi Alice
</code></pre><blockquote>
<p>There&rsquo;s a bug here because Alice is getting a message from herself. Her <code>hi all</code> had no recipient, so it went to all participants - including herself. Just like Charlie answering <code>hi Alice</code> but without a recipient.</p>
</blockquote>
<p>Participants do not need to know about each other to send messages to each other, this is handled by the <code>Mediator</code> in the form of a<code> SuperChat</code> object. Additionally, it has its internal messaging policy, it is not just a proxy between objects. The chat could have a list of muted participants who, e.g. temporarily and as a punishment, cannot send messages. But instead of blocking messages from being sent, you can block messages from being delivered without alerting the participant about the `shadowban.</p>
<h1 id="naming">Naming</h1>
<p><code>Mediator</code> is a very simple pattern in terms of structure, it&rsquo;s basically a single interface. There is no need to add this to the name of objects that act as Mediator. Depending on the implementation, <code>Mediator</code> may not even be visible outside, unlike the <code>Facade</code>, that by definition, is an entry interface to some functionality.
For this reason, I would definitely avoid using the name Mediator in class names. Even the <code>notify()</code> method can and should refer to the domain of the problem being solved, as in the <code>send()</code> chat. This pattern should be transparent outside the class group and be only an implementation detail, and organizational improvement.</p>
<h1 id="summary">Summary</h1>
<p>The Mediator&rsquo;s job is to organize communication between close classes. The <code>Mediator</code> pattern cuts out dependencies between components. It takes over the interaction between them, becoming the main communication hub for a group of classes. There is a reverse of the controls because components are now just telling &ldquo;what happened&rdquo; instead of telling others to &ldquo;do something&rdquo;. It can be found e.g. in the form of <code>ViewModel</code> in Android, where it separates UI interactions from data model changes.</p>
<p>The mediator, using internal logic, decides what to do with the information coming from one of his components. It can call a method on one or more components. Therefore, it needs to know the specific interfaces of the components, not some generics derived from the pattern. Theoretically, a <code>Component</code> may also have only the <code>notify()</code> method and decide for itself how to react to a given message from the <code>Mediator</code> (two-way mediation), but this significantly complicates the matter and starts to be a different pattern.</p>
<p>Be careful, so the &lsquo;Mediator&rsquo; does not turn into a so-called <strong>god object</strong>, expanded and complex, containing much of the system logic. The mediator should be used locally rather than as an access interface to functionality, unlike Facade.</p>
<p>It&rsquo;s well suited for refactoring. If you have a group of related classes that are cumbersome to reuse by the number of dependencies. It also improves testing, because there is no need to create mocks for a group of classes, but only the Mediator. If all interactions between components are contained in the Mediator, using the same components but in a different context will only require writing a new Mediator.</p>
<h2 id="pros">Pros</h2>
<ul>
<li><strong>no dependencies</strong> - The mediator takes over the communication between the components, so they don&rsquo;t need to know about each other.</li>
<li><strong>testing</strong> - Mediator mock/stub is enough to test the class, no need to create a whole dependency tree.</li>
<li><strong>easy code reuse</strong> - lack of dependencies makes using the class in new places easy. You can even reuse whole functionality in a new context by creating a new Mediator object with no component changes.</li>
<li><strong>refactoring</strong> - Mediator allows to untangle the mutual dependencies of a &ldquo;mature&rdquo; code, where class responsibilities are already established, but the amount of mutual interactions starts to be a problem.</li>
</ul>
<h2 id="cons">Cons</h2>
<ul>
<li><strong>god object</strong> - can expand to enormous dimensions, &ldquo;swallowing&rdquo; subsequent components and become an access point to functionality, instead of just an organizer for communication.</li>
<li><strong>covers the problem instead of solving it</strong> - shifting all communication and dependencies between components to Mediator may cause objects to still depend on each other, but implicitly. Instead of having references to themselves in the code, they will still expect certain Mediator calls to do their job properly.</li>
</ul>

  
  <hr>
<div class="footer">
    
	    
            <a class="previous-post" href="http://localhost:1313/kotlin-decorator-pattern/?ref=footer"><span style="font-weight:bold;">« Previous</span><br>Decorator Pattern in Kotlin</a>
        
	    
            <div class="next-post">
                <a href="http://localhost:1313/remote-logger/?ref=footer"><span style="font-weight:bold;">Next »</span><br>Remote Logger</a>
            </div>
        
    
</div>

  
</div>
            </main>
            
  
    <div class="article-toc ">
    <div class="toc-wrapper">
      <h4 id="contents"></h4>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#abstract-implementation">Abstract implementation</a></li>
    <li><a href="#dialog">Dialog</a></li>
    <li><a href="#chat">Chat</a></li>
  </ul>

  <ul>
    <li><a href="#pros">Pros</a></li>
    <li><a href="#cons">Cons</a></li>
  </ul>
</nav>
    </div>
</div>

  

        </div>
    </body>
</html>
